<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="friendMapper">

<select id="myfriendList" parameterType="string" resultType="string">
select *
from(
	select m2.user_id
	from member m1
	join friend f ON m1.user_no = f.user_no_1
	join member m2 ON f.user_no_2 = m2.user_no
	where m1.user_id = #{user_id}
	union
	select m1.user_id
	from member m2
	join friend f ON m2.user_no = f.user_no_2
	join member m1 ON f.user_no_1 = m1.user_no
	where m2.user_id = #{user_id}
)
order by asc
</select>

<insert id="insert" parameterType="friedIn">
insert into friend(user_no_1, user_no_2)
values (
	(
		select user_no
		from memeber
		where user_id = #{id1}
	)
	,(
		select user_no
		from memeber
		where user_id = #{id2}
	)
)
</insert>

<delete id="delete" parameterType="friendIn">
delete from friend
where user_no_1 = 	(
		select user_no
		from memeber
		where user_id = #{id1}
	)
and user_no_2 = (
		select user_no
		from memeber
		where user_id = #{id2}
	)
</delete>

</mapper>
